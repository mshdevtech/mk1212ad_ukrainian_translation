# README · Правила для перекладачів

> Цей репозиторій містить **український переклад** і **знімок оригіналу англійською** (`_upstream/`).  
> Перекладачі працюють тільки в цьому репо й надсилають Pull Request-и (**PR**) у захищену гілку `main`.

---

## 1  Швидкий старт

```bash
# 1 — клонувати
git clone https://github.com/mshdevtech/mk1212ad_ukrainian_translation.git
cd <repo>

# 2 — створити власну робочу гілку
git checkout -b l10n/<ваш-нік>/<назва_файлу_який_перекладаєте>

# 3 — відкрити .loc.tsv у CLion → вкладка «Data» → редагувати колонку text
# 4 — коміт + пуш
git add text/db/*.loc.tsv
git commit -m "uk: переклад factions рядки 100–150"
git push -u origin HEAD

# 5 — створити PR → base = main, head = ваша гілка
```

## 2 Обов’язкові інструменти

| Що                            | Мінімальна версія | Де взяти                                                               |
| ----------------------------- | ----------------- | ---------------------------------------------------------------------- |
| **Git**                       | 2.40+             | [https://git-scm.com/downloads](https://git-scm.com/downloads)         |
| **Python**                    | 3.9+              | [https://www.python.org/downloads/](https://www.python.org/downloads/) |
| **CLion**                     | 2023.3+           | [https://www.jetbrains.com/clion/](https://www.jetbrains.com/clion/)   |
| **Плагін “Translation”**      | актуальна         | *CLion → Settings → Plugins → Marketplace*                             |

## 2.1 Встановлення Git
* Windows: інсталятор <em>Git for Windows</em> → у майстрі обрати «Checkout as-is, commit Unix-style line endings».
* macOS: `brew install git`
* Linux: `sudo apt install git` / `sudo pacman -S git`

## 2.2 Встановлення Python + pandas
```
python -m pip install --upgrade pip
pip install pandas
```

## 2.3 Налаштування CLion

1. Відкрити репозиторій: **File → Open**.
2. Переконатись, що модуль **Database Tools & SQL** увімкнено.
3. У <em>Settings → Plugins → Marketplace</em> встановити **Translation**.
4. Відкрити <em>.loc.tsv</em>, вибрати вкладку **Data** унизу ― з’явиться табличний режим.

## 2.4 Синхронізація перекладу для гри

Щоб швидко скопіювати всі файли перекладу у папку мода для тестування в грі, використовуйте скрипт:

```bash
python scripts/sync_translation.py
```

Скрипт повністю очищає папку `c:/users/Max/TWMods/MK1212AD_Ukrainization` і копіює туди всі файли з `translation/`.

## 2.5 Автоматична синхронізація при коміті (pre-commit hook)

Щоб переклад автоматично синхронізувався при кожному git commit, додайте pre-commit hook:

1. Створіть (або відредагуйте) файл `.git/hooks/pre-commit` у корені репозиторію.
2. Додайте у файл такий вміст (для Windows):

    ```bat
    @echo off
    REM Pre-commit hook: синхронізація перекладу
    python scripts/sync_translation.py
    if errorlevel 1 (
      echo Синхронізація не вдалася. Коміт скасовано.
      exit /b 1
    )
    ```
3. Збережіть файл **без розширення** (`pre-commit`, не `pre-commit.txt`).
4. Тепер при кожному коміті скрипт буде запускатися автоматично.

> **Примітка:**
> - Файл `.git/hooks/pre-commit` не потрапляє у git-репозиторій, тому кожен учасник має налаштувати його самостійно.
> - Для Linux/macOS використовуйте bash-версію hook (запитайте, якщо потрібно).

## 3 Структура репозиторію

```
_upstream/text/db/*.loc.tsv   ── оригінал EN (оновлюється рідко)
text/db/*.loc.tsv             ── український переклад (читає гра)
scripts/
  merge_tsv.py                ── додає нові key, не затирає переклад
  validate_tsv.py             ── перевірка TSV перед комітом
obsolete/                     ── автоматичний архів видалених key
```

## 4 Робочий процес перекладача
| Крок | Дія                                                                           |
| ---- |-------------------------------------------------------------------------------|
| 0    | `git pull origin main` — оновити базу.                                        |
| 1    | `git checkout -b l10n/<ваш_нік>/<назва_файлу_який_перекладаєте>` — нова гілка. |
| 2    | У CLion → **Data** → сховати колонку `tooltip` і перекладати колонку `text`.  |
| 3    | Комітити невеликі порції (`git add`, `git commit`).                           |
| 4    | `git push` → створити PR у `main`.                                            |
| 5    | Дочекатися CI та **review** від maintainer’а.                                 |

> **Merge-конфлікт?**
> 
> ``git fetch origin && git rebase origin/main``, виправити, ``git rebase --continue``, ``git push --force-with-lease``
> 
> Або користуємось вбудованим інтерфейсом CLion для виправлення конфліктів.
> 

## 5 Вимоги до комітів і PR-ів
1. **Формат повідомлення**
    ```
     переклад <файл> рядки X–Y
    ```
2. Змінювати **тільки** колонку `text`.
3. Не видаляти ключі, не міняти порядок колонок.
4. Один PR ≈ до 500 рядків.
5. Перед пушем:
    ```
    python scripts/validate_tsv.py
    git diff
    ```
6. Оновлення оригіналу (maintainer)
    ```
    cp <нові EN файли> _upstream/text/db/
    python scripts/merge_tsv.py
    git add _upstream text/db
    git commit -m "Sync upstream EN (vX.Y)"
    git push
    ```

## 7 Шпаргалка CLion

| Дія                                 | Клавіші / меню                                                                                              |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------|
| Перегляд таблиці                    | Вкладка **Data**                                                                                            |
| Фільтр колонок по «ключовим словам» | **Filter Rows** → `mk_`                                                                                     |
| Редагувати клітинку                 | Double-click / `F2`                                                                                         |
| Пошук                               | `Ctrl + F`                                                                                                  |
| Швидкий переклад                    | Переходимо в режим Text → Виділити текст → Викликаємо контекстне меню і вибираємо Translate/Переклад |

## 8 Стиль перекладу (коротко)

* Термінологія — див. `TERMS.md`.
* Зберігати регістр власних назв.
* Римські цифри та акроніми: **AI** → допускається **ІІ**; якщо це назва параметра ― лишити англійською.
* Клаптики тексту не повинні бути > 1.2× довжини оригіналу.
* Використовувати звичайні подвійні лапки " ".

## 9 Корисні Git-команди
| Що                       | Команда                     |
| ------------------------ | --------------------------- |
| Список гілок             | `git branch`                |
| Показати зміни           | `git diff --color-words`    |
| Ігнорувати пробіли       | `git diff -w`               |
| Відкотити останній коміт | `git reset --soft HEAD~1`   |
| Сквош перед PR           | `git rebase -i origin/main` |

## 10 Поради по перекладу

Для максимальної зручності в режимі **Data** у CLion ви можете скопіювати цілу колонку з оригінальним текстом, потім вставити в Google Translate та DeepL (для максимально точного перекладу краще використовувати обидва та додатково ще перевіряти в гуглі деякі переклади, якщо сумніваєтесь), потім в Google Sheets робите 4 колонки: Оригінальний текст, Переклад гугл, Переклад DeepL та четверту для остаточного варіанту перекладу. Коли все готово, ви копіюєте цілу колонку з остаточним перекладом, йдете в CLion, виділяєте колонки які необхідно перекласти і за допомогою команди CTRL+V вставляєте переклад.
Бажано це робити порціями, тому що Google Translate та DeepL мають обмеження до 5000 символів.
Кожну порцію для зручності можете перекладати в окремому листі Google Sheets.

🚀 Вдалого перекладу!
Питання — тегайте @mshdevtech у PR або пишіть у розділ `Ideas` чи `Q&A`.
